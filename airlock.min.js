/* | Airlock.js - v1.0.2
   | http://www.searchdiscovery.com/airlock */
!function(a,b){"use strict";function c(a){return a}function d(a,b){var c=[].slice.call(arguments,2);return function(){return a.apply(b,[].concat.apply(c,arguments))}}function e(){this._contents={},this._defaultKey="t0"}var f={};f.settings=a._airlock||{},f.settings.dimensionMap=f.settings.dimensionMap||{},function(a,b,c,d,e,g,h){a.GoogleAnalyticsObject&&a[a.GoogleAnalyticsObject]||(a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},f.settings.loadUA!==!1&&(a[e].l=1*new Date,g=b.createElement(c),h=b.getElementsByTagName(c)[0],g.async=1,g.src=d,h.parentNode.insertBefore(g,h)))}(a,b,"script","//www.google-analytics.com/analytics"+(f.settings.debug?"_debug":"")+".js",f.settings.gaNamespace||"ga"),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;d>c;++c)c in this&&a.call(b,this[c],c,this)});var g=a._gaq,h={actions:/^([\w\d_-]+)?\.?(_track(Event|Pageview|Trans|Social|Timing)|_add(Item|Trans)|_set(CustomVar|Account|DomainName|AllowLinker|SampleRate|CookiePath|SiteSpeedSampleRate)?|_link|_require)$/,setupActions:/^(.+\.)?_(set(Account|CustomVar|DomainName|AllowLinker|SampleRate|CookiePath|SiteSpeedSampleRate)?)$/,ecommerceActions:/^(.+\.)?_(add(Trans|Item)|trackTrans)$/,writeableSet:/^page|title$/};e.prototype.get=function(a){return a=a||this._defaultKey,this._contents[a]},e.prototype.set=function(a,b){return a=a||this._defaultKey,this._contents[a]=b,this},e.prototype.has=function(a){return a=a||this._defaultKey,!!this._contents[a]},e.prototype.forEach=function(a,b){for(var c in this._contents)this._contents.hasOwnProperty(c)&&a.call(b,this._contents[c],c,this._contents)};var i=function(a,b){if("object"==typeof a){var c=a;return a=c.get("name"),b=c.get("trackingId"),new i(a,b).initialize()}this.settings={},this._settings={},this.namespace=a,this.account=b,this.setupQueue=[],this.initialized=!1,this.settings.name=this.namespace};i.prototype.setAccount=function(a){return this.account=a,this},i.prototype.initialize=function(){return this.setupQueue.forEach(function(a){a()}),this.initialized=!0,this},f.spaceships=new e,f.readAction=function(a){var b=a.match(h.actions);return b?{namespace:b[1],action:b[2]}:null},f.initialize=function(){var b=[],c=a[a.GoogleAnalyticsObject];if(c.q){var e=[].concat(c.q),j=0;c.q.forEach(function(b,c){"string"==typeof b[0]&&"create"===b[0]&&(j=j+c+1,e.splice(j,0,[function(){var c=a[a.GoogleAnalyticsObject],d=b[b.length-1],e="object"==typeof d&&d.name?d.name:"t0",g=c.getByName(e),h=new i(g);f.dock(h)}]))}),c.q=e}c.P&&c.P.forEach(function(a){var b=new i(a);this.dock(b)},this),g.forEach(function(a){if("function"==typeof a)return f.open(null,a),void 0;var c=f.readAction(a[0]);if(c)return h.setupActions.test(c.action)?(this.spaceships.has(c.namespace)||this.dock(new i(c.namespace)),this.pressurize(a,this.spaceships.get(c.namespace)),void 0):(b.push(a),void 0)},this),Array.prototype.splice.apply(g,[0,g.length].concat(b)),this.spaceships.forEach(function(a){f.open(a,["create",a.account,a.settings])}),g.push=function(a){if("function"==typeof a)return f.open(null,a);var b=f.readAction(a[0]);if(b){h.ecommerceActions.test(b.action)&&!f.ecommerceInitialized&&(f.ecommerceInitialized=!0,f._open(["require","ecommerce","ecommerce.js"]));var c=f.spaceships.get(b.namespace);c&&(a=f.pressurize(a,c),f.open(c,a))}},g.forEach(d(g.push,g))},f.dock=function(a){this.spaceships.set(a.namespace,a)},f.open=function(a,b){if("function"==typeof b)return f._open([b]);if(a&&a.account){var c="create"===b[0];b&&(b[0]=!a.namespace||c?b[0]:[a.namespace,b[0]].join("."),f._open(b),c&&a.initialize())}},f._open=function(b){return a[a.GoogleAnalyticsObject].apply(a,b)},f.pressurize=function(a,b){var c=f.conversions[a.splice(0,1)[0].replace(h.actions,"$2")];if(c){if("function"==typeof c)return c.apply(b,a);for(var d={},e=[],g=0,i=a.length<c.input.length?a.length:c.input.length;i>g;g++)d[c.input[g]]=a[g];return g=0,i=c.output.length,c.output.forEach(function(a){var b=j(a,d);b&&e.push(b)}),e}};var j=function(a,b){if("function"==typeof a)return a(b);var c=a.match(/\[\[([a-zA-Z_]+)\]\]/);if(c){if(!b[c[1]])return;return a.replace(c[0],b[c[1]])}return a};if(f.conversions={_setAccount:function(a){this.setAccount(a)},_setSampleRate:function(a){this.settings.sampleRate=a},_setSiteSpeedSampleRate:function(a){this.settings.siteSpeedSampleRate=a},_setCookiePath:function(a){this.settings.cookiePath=a},_set:function(a,b){return this.settings[a.replace("ua","cookie")]=b,h.writeableSet.test(a)?["set",a,b]:void 0},_setDomainName:function(a){this._settings.domainName=a},_setAllowLinker:function(a){var b=this;this.settings.allowLinker=a,this.setupQueue.push(function(){f._open(["require","linker"]),f.open(b,["linker:autoLink",b._settings.domainName])})},_require:function(a){return"inpage_linkid"===a?["require","linkid","linkid.js"]:void 0},_setCustomVar:function(a,b,c){var e,g=f.settings.dimensionMap;return a=g[a]||g[b]||a,e=["set","dimension"+a,c],this.initialized?e:(this.setupQueue.push(d(f.open,f,this,e)),void 0)},_trackEvent:{input:["eventCategory","eventAction","eventLabel","eventValue","nonInteraction"],output:["send","event",c]},_trackPageview:{input:["pagePath"],output:["send","pageview","[[pagePath]]"]},_trackTiming:{input:["timingCategory","timingVar","timingValue","timingLabel"],output:["send","timing",c]},_trackSocial:{input:["socialNetwork","socialAction","socialTarget","page"],output:["send","social",c]},_addTrans:{input:["id","affiliation","revenue","tax","shipping"],output:["ecommerce:addTransaction",c]},_addItem:{input:["id","sku","name","category","price","quantity"],output:["ecommerce:addItem",c]},_trackTrans:{input:[],output:["ecommerce:send"]}},f.settings.conversions){var k=f.settings.conversions;for(var l in k)k.hasOwnProperty(l)&&(f.conversions[l]=k[l])}f.settings.autoInit!==!1&&f.initialize(),(f.settings.autoInit===!1||f.settings.expose)&&(a.Airlock=f),"function"==typeof define&&define.amd&&define("airlock",[],function(){return f})}(window,document);
