/* | Airlock.js - v0.1.2
   | http://searchdiscovery.com/ */
!function(a,b){!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(a,b,"script","//www.google-analytics.com/analytics.js","ga");var c,d,e=a._gaq,f={actions:/^([\w\d_-]+)?\.?(_track(Event|Pageview|Trans|Social|Timing)|_add(Item|Trans)|_set(CustomVar|Account|DomainName|AllowLinker|SampleRate|CookiePath)?|_link|_require)$/,setupActions:/^(.+\.)?_(set(Account|CustomVar|DomainName|AllowLinker|SampleRate|CookiePath)?)$/,ecommerceActions:/^(.+\.)?_(add(Trans|Item)|trackTrans)$/,writeableSet:/^page|title$/},g=function(){this._contents={},this._defaultKey="__default__"};g.prototype.get=function(a){return a=a||this._defaultKey,this._contents[a]},g.prototype.set=function(a,b){return a=a||this._defaultKey,this._contents[a]=b,this},g.prototype.has=function(a){return a=a||this._defaultKey,!!this._contents[a]},g.prototype.each=function(a,b){for(var c in this._contents)this._contents.hasOwnProperty(c)&&a.call(b,this._contents[c],c,this._contents)};var h=function(a){this.settings={},this._settings={},this.namespace=a,this.setupQueue=[],this.initialized=!1,this.settings.name=this.namespace};h.prototype.setAccount=function(a){this.account=a},h.prototype.initialize=function(){for(c=0,d=this.setupQueue.length;d>c;c++)this.setupQueue[c]();this.initialized=!0};var i={};i.spaceships=new g,i.readAction=function(a){var b=a.match(f.actions);return{namespace:b[1],action:b[2]}},i.initialize=function(){var b,g,j=[];for(c=0,d=e.length;d>c;c++)g=null,"function"!=typeof e[c]?(b=i.readAction(e[c][0]),f.setupActions.test(b.action)?(this.spaceships.has(b.namespace)||(g=new h(b.namespace),this.dock(g)),this.pressurize(e[c],this.spaceships.get(b.namespace))):j.push(e[c])):i.pressurize(e[c]);for(Array.prototype.splice.apply(a._gaq,[0,e.length].concat(j)),this.spaceships.each(function(a){i.open(a,["create",a.account,a.settings])}),a._gaq.push=function(b){if("function"==typeof b)return i.pressurize(b);var c=b[0];if(f.actions.test(c)){f.ecommerceActions.test(c)&&!i.ecommerceInitialized&&(i.ecommerceInitialized=!0,a.ga("require","ecommerce","ecommerce.js"));var d=i.spaceships.get(i.readAction(c).namespace);d&&(b=i.pressurize(b,d),i.open(d,b))}},c=0,d=e.length;d>c;c++)e.push(e[c])},i.dock=function(a){this.spaceships.set(a.namespace,a)},i.open=function(b,c){if(b.account){var d="create"===c[0];c&&(c[0]=!b.namespace||d?c[0]:[b.namespace,c[0]].join("."),a.ga.apply(a,c),d&&b.initialize())}},i.pressurize=function(a,b){if("function"==typeof a)try{return a()}catch(c){console&&console.warn&&console.warn("AIRLOCK: function passed to _gaq threw error",e[k].toString(),c)}var d=i.conversions[a.splice(0,1)[0].replace(f.actions,"$2")];if(d){if("function"==typeof d)return d.apply(b,a);for(var g={},h=[],k=0,l=a.length<d.input.length?a.length:d.input.length;l>k;k++)g[d.input[k]]=a[k];for(k=0,l=d.output.length;l>k;k++){var m=j(d.output[k],g);m&&h.push(m)}return h}};var j=function(a,b){if("function"==typeof a)return a(b);var c=a.match(/\[\[([a-zA-Z_]+)\]\]/);if(c){if(!b[c[1]])return;return a.replace(c[0],b[c[1]])}return a},k=function(a){return a};i.conversions={_setAccount:function(a){this.setAccount(a)},_setSampleRate:function(a){this.settings.sampleRate=a},_setCookiePath:function(a){this.settings.cookiePath=a},_set:function(a,b){return this.settings[a.replace("ua","cookie")]=b,f.writeableSet.test(a)?["set",a,b]:void 0},_setDomainName:function(a){this._settings.domainName=a},_setAllowLinker:function(b){var c=this;this.settings.allowLinker=b,this.setupQueue.push(function(){a.ga("require","linker"),i.open(c,["linker:autoLink",c._settings.domainName])})},_require:function(a){return"inpage_linkid"===a?["require","linkid","linkid.js"]:void 0},_setCustomVar:function(a,b,c){var d=["set","dimension"+a,c];return this.initialized?d:(this.setupQueue.push(i.open.bind(i,this,d)),void 0)},_trackEvent:{input:["eventCategory","eventAction","eventLabel","eventValue","nonInteraction"],output:["send","event",k]},_trackPageview:{input:["pagePath"],output:["send","pageview","[[pagePath]]"]},_trackTiming:{input:["timingCategory","timingVar","timingValue","timingLabel"],output:["send","timing",k]},_trackSocial:{input:["socialNetwork","socialAction","socialTarget","page"],output:["send","social",k]},_addTrans:{input:["id","affiliation","revenue","tax","shipping"],output:["ecommerce:addTransaction",k]},_addItem:{input:["id","sku","name","category","price","quantity"],output:["ecommerce:addItem",k]},_trackTrans:{input:[],output:["ecommerce:send"]}},i.initialize(),a.Airlock=i}(window,document);